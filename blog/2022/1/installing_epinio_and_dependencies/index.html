<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>How we Install Dependencies for Epinio</title><link rel=stylesheet type=text/css href=/sass/blog.min.css?1642178644><script async defer src=https://buttons.github.io/buttons.js></script><script type=text/javascript src=//cdn.bizible.com/scripts/bizible.js async></script></head><body><header><div class=sub-header><a class=navbar-brand href><img src=/images/logo-epinio.svg alt=Epinio></a><nav><ul class=menu><li><a href=/blog class="btn no-bg">Blog</a></li><li><a href=https://artifacthub.io/packages/helm/epinio/epinio class="btn no-bg" target=_blank>Helm Charts</a></li><li><a href="https://rancher-users.slack.com/?redir=%2Fmessages%2Fepinio" class="btn no-bg" target=_blank>Slack</a></li><li><a href=https://docs.epinio.io class="btn no-bg" target=_blank>Documentation</a></li><li><a href=https://github.com/epinio/epinio class=btn><img src=/images/icon-github.svg><span>Github</span></a></li></ul></nav></div></header><link rel=stylesheet href=/css/blog.css><section class=intro><div class=bg-primary><div class="wrap grid-one"><div><h1 style=color:#fff><a href=/blog>The Epinio blog</a>
<a href=/blog/index.xml><img src=/images/icon-rss.svg class=fill-white height=20></a></h1></div></div></div></section><main><section class=wrap><article><h1>How we Install Dependencies for Epinio</h1><author>Mario Manno</author>
<time>13 Jan 2022</time><div id=blog-post-content><hr><p><a href=https://epinio.io/>Epinio</a> is meant to put your application on Kubernetes with one command, without any prior Kubernetes knowledge. To do that, Epinio relies on a set of well-established open-source components, like Tekton, a docker registry and <a href=https://buildpacks.io/>Cloud Native buildpacks</a>.</p><p>The latest <a href=https://github.com/epinio/epinio/releases>Epinio release</a> comes with two helm charts, one for installing just Epinio, the other installs Epinio with all dependencies configured. Look at the <a href=https://docs.epinio.io/installation/installation.html>installation docs</a> if you want to jump right in.</p><h2 id=orchestrating-application-deployment-on-kubernetes>Orchestrating Application Deployment on Kubernetes</h2><p>How hard it is to install a set of interdependent applications on a cluster has been troubling the Epinio developer team again and again.</p><p>This article is not about applications that users deploy with Epinio, but rather about Epinio as an application itself. Epinio’s runtime dependencies, the components, must be installed in a certain order; configuration must be applied, and you must wait for Kubernetes resources to be ready and usable. For example, pods serving admission webhooks must be up and running, SSL certificates must have been generated, etc.</p><p>Managing complex deployments is the domain of software provisioning tools like Ansible, or maybe Helmfile. Though, when using Helmfile one would have to put configuration into a separate chart and control the installation order.</p><blockquote><p>“The Epinio team ships releases, we don&rsquo;t manage one infrastructure, we need an installer that works with any cluster”</p></blockquote><p>The latest Epinio version (0.3.x) now ships a <a href=https://artifacthub.io/packages/helm/epinio/epinio>standalone Epinio helm chart</a>. All dependencies have been removed. Because, we just can&rsquo;t tell if Epinio is installed in an existing cluster, if components should be re-used. After all, how many cert-manager installations do you need in your production cluster? Indeed, one.</p><p>But sometimes you don&rsquo;t care, you&rsquo;re using a fresh cluster, or a local cluster (like k3s, <a href=https://rancherdesktop.io/>Rancher Desktop</a>). This is also the case for our CI, when we test Epinio, we spin up a cluster and deploy the standard set of components.</p><p>For that case, we have another chart, the <a href=https://artifacthub.io/packages/helm/epinio/epinio-installer>Epinio installer chart</a>. The new installer, used in that chart, takes a manifest and deploys all listed dependencies.</p><p>While the installer is kept simple on purpose, as we consider it more of an internal tool, it can update existing deployments.</p><p>It also doesn&rsquo;t take ownership of the components. Most dependencies are helm charts. When problems arise, like temporary download errors, these can be fixed with helm directly. E.g., by doing a <code>helm rollback</code>.</p><p>Previously you had to uninstall first, then re-install all dependencies, now you can just run the installer again, as it&rsquo;s much more idempotent.</p><h2 id=use-case-faster-installation-on-rancher-desktop>Use case: Faster Installation on Rancher Desktop</h2><p>If you&rsquo;re deploying Epinio in RD, you might want to skip Linkerd. There is not much reason to add SSL to localhost traffic on a desktop machine.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>helm upgrade --install -n epinio --create-namespace --set &#34;skipLinkerd=true&#34; epinio-installer https://github.com/epinio/helm-charts/releases/download/epinio-installer-0.3.4/epinio-installer-0.3.4.tgz
</code></pre></div><p>With the new installation methods, Epinio gained lots of flexibility. It’s easier for the team to test different components. For example, we&rsquo;re looking forward to trying Nginx instead of Traefik as an ingress. Maybe, all we have to do is switch the manifest to Nginx, without recompiling!?</p></div><div><ul id=tags></ul></div><div></div></article></section></main><footer><p>&copy; 2022 SUSE. Epinio is an open source project of the <a href=https://suse.com>SUSE</a> <a href=https://rancher.com>Rancher</a> Engineering group.</p><div class=project-icons><a href=https://k3s.io target=blank><img src=/images/icon-k3s.svg height=20></a>
<a href=https://harvesterhci.io target=blank><img src=/images/icon-harvester.svg height=20></a>
<a href=https://rancherdesktop.io target=blank><img src=/images/icon-rancher-desktop.svg height=20></a>
<a href=https://kubewarden.io target=blank><img src=/images/icon-kubewarden.svg height=20></a>
<a href=https://hypper.io target=blank><img src=/images/icon-hypper.svg height=20></a></div></footer><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-56382716-12','auto'),ga('set','anonymizeIp',!0),ga('send','pageview'))</script></body></html>